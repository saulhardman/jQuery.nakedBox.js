/**
 * jQuery Naked Box 0.1
 * https://github.com/saulhardman/jquery.nakedbox.js
 * Saul Hardman (@saulhardman)
 */(function(a){a.fn.nakedBox=function(b){var c={overlayColor:"rgba(20, 20, 20, .8)",boxShadow:"0 0 10px rgba(20, 20, 20, .8), 0 0 40px rgba(20, 20, 20, .8)",borderColor:"#fff",borderSize:0,pathToImage:"img/imageLoader.gif",speed:500,keyboard:!0},d=a.extend({},c,b),e=a(this),f,g,h,i,j,k,l,m,n,o={initialised:!1,hasNavigation:!1,inProgress:!1,createElements:function(){f=a("<div/>",{id:"overlay"}).css({top:0,left:0,height:"100%",width:"100%",position:"fixed",backgroundColor:d.overlayColor});g=a("<div/>",{id:"viewer"});g.css({position:"absolute",top:"50%",left:"50%",marginTop:-(g.height()+d.borderSize*2)/2,marginLeft:-(g.width()+d.borderSize*2)/2,padding:d.borderSize,backgroundColor:d.borderColor,boxShadow:d.boxShadow});h=a("<img>",{id:"loader",src:d.pathToImage,alt:"Loader"}).css({position:"absolute",top:"50%",left:"50%",margin:"-8px 0 0 -8px"});var b=e.filter("[rel]");b.length>0&&b.each(function(){var c=a(this);if(b.filter("[rel="+c.attr("rel")+"]").length>1){o.hasNavigation=!0;return!1}});if(o.hasNavigation){var c={position:"absolute",height:"100%",width:"50%",top:0,opacity:0,backgroundColor:"#fff"};j=a("<a/>",{id:"nextLink","class":"navLink"}).css(c).css("right",0);k=a("<a/>",{id:"previousLink","class":"navLink"}).css(c).css("left",0)}f.append(g).appendTo("body")},bindEventListeners:function(){f.click(function(){f.fadeTo(d.speed,0,function(){f.hide().removeClass("shown");g.css({height:16,width:16,marginTop:-(16+d.borderSize*2)/2,marginLeft:-(16+d.borderSize*2)/2})})});g.on("click",".navLink",function(b){b.preventDefault();b.stopPropagation();if(o.inProgress)return!1;o.inProgress=!0;var c=a(this);c.attr("id")==="nextLink"?n++:n--;i.fadeTo(d.speed,0,function(){a(this).detach();g.append(h);j.add(k).detach();o.loadImage(c.attr("href"))})});o.hasNavigation&&j.add(k).hover(function(){a(this).css("opacity",.2)},function(){a(this).css("opacity",0)});d.keyboard&&a(document).keydown(function(a){switch(a.keyCode){case 27:f.trigger("click");break;case 37:k.trigger("click");break;case 39:j.trigger("click")}})},loadImage:function(b){var c=new Image;c.src=b;c.onload=function(){i=a(c).attr("id","magnified").css({opacity:0,filter:"alpha(opacity=0)"});g.animate({height:c.height,width:c.width,marginTop:-(c.height+d.borderSize*2)/2,marginLeft:-(c.width+d.borderSize*2)/2},d.speed,function(){h.detach();g.append(i);o.hasNavigation&&o.setNavigation();i.fadeTo(d.speed,1,function(){o.inProgress=!1})})}},setNavigation:function(){j.add(k).detach();if(l.length)if(n===0)j.attr("href",l.eq(n+1).attr("href")).appendTo(g);else if(n>0&&n<l.length-1){j.attr("href",l.eq(n+1).attr("href")).appendTo(g);k.attr("href",l.eq(n-1).attr("href")).appendTo(g)}else k.attr("href",l.eq(n-1).attr("href")).appendTo(g)}};return e.click(function(b){b.preventDefault();var c=a(this);if(o.initialised===!1){o.createElements();o.bindEventListeners();o.initialised=!0}f.show().fadeTo(d.speed,1,function(){f.addClass("shown")});if(o.hasNavigation){o.hasNavigation=!0;m=c.attr("rel");l=e.filter("[rel="+m+"]");n=l.index(c)}g.append(h);typeof i!="undefined"&&i.detach();o.hasNavigation&&j.add(k).detach();o.loadImage(c.attr("href"));return!1})}})(jQuery);